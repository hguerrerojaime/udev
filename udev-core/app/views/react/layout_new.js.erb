import React from 'react';

import { c,f,core } from 'udev';

import <%=@domain_object.class_name%>_Form from 'core/l/<%=@layout_instance.id.to_s%>/form';

export default class <%=@domain_object.class_name%>_New extends React.Component {

  constructor(props) {
    super(props);

    this.state = {
      record: {
        <%=
          @layout_instance.layout_fields.collect { |field|
            "#{field.name}: undefined"
          }.join(",\n\t\t")
        %>
      }
    };

  }

  render() {
    return (
      <c.Panel brand="primary" title="New <%=@domain_object.label%>">
        <f.Form onSubmit={this.submit.bind(this)}>
          <c.Well size="sm">
            <f.RecordActionBar mode="new" params={this.props.params} />
          </c.Well>
          <<%=@domain_object.class_name%>_Form stateHolder={this}/>
          <hr />
          <c.Well size="sm">
            <f.RecordActionBar mode="new" params={this.props.params} />
          </Well>
        </f.Form>
      </c.Panel>
    );
  }

  submit(evt) {


     let service = core.resolver.get("recordService");

     core.alert.confirm("Are you sure?",()=> {
         service.create("<%=@domain_object.id.to_s%>",this.state.record).then((saved) => {
            //  browserHistory.push('/provider/'+saved.id);
         });
     });
  }

}
